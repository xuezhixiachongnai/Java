# 异常的统一处理

## 概念

统一异常处理的必要性体现在保持代码的一致性、提供更清晰的错误信息、以及更容易排查问题。通过定义统一的异常处理方式，确保在整个应用中对异常的处理保持一致，减少了重复编写相似异常处理逻辑的工作，同时提供友好的错误信息帮助开发者和维护人员更快地定位和解决问题，最终提高了应用的可维护性和可读性。

## 定义通用相应对象

实现统一返回结果

```java
@Data
public class ResultResponse implements Serializable {
    
}
```

## 定义统一的异常类

定义服务中可能抛出的自定义异常类。这些类可以继承自`RuntimeException`

```java
@Data
public class ServiceException extends RuntimeException {
    
}
```

## 局部异常处理

`@ExceptionHandler`注解可以用来处理局部异常。该注解在一个`@Controller`控制器类中使用只会在当前类中生效

```java
@RestController
public class TestController {
    @RequestMapping("/test")
    public ResultResponse test() {
        throw new ServiceException();
    }
    
    @ExceptionHandler(ServiceException.class)
    public ResultResponse handleServiceException(ServiceException e) {
        
    }
}
```



## 全局异常处理器

使用`@ControllerAdvice` 或者 `@RestControllerAdvice`注解创建一个全局的异常处理器，该类会拦截所有控制器抛出的异常，再通过`@ExceptionHandler`注解来捕获不同类型的异常，并定义处理逻辑。

```java
@ControllerAdvice // 该注解放到一个类上，用于声明一个全局异常处理器
public class ExceptionAdvice {
    
    // 用于定义异常处理方法，处理特定类型的异常。放在全局异常处理器类中的具体方法上
    @ExceptionHandler(ServiceException.class) 
    @ResponseBody
    public ResultResponse handleServiceException(ServiceException e) {
        
    }
}
```
